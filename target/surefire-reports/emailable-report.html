<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>TestNG Report</title><style type="text/css">table {margin-bottom:10px;border-collapse:collapse;empty-cells:show}th,td {border:1px solid #009;padding:.25em .5em}th {vertical-align:bottom}td {vertical-align:top}table a {font-weight:bold}.stripe td {background-color: #E6EBF9}.num {text-align:right}.passedodd td {background-color: #3F3}.passedeven td {background-color: #0A0}.skippedodd td {background-color: #DDD}.skippedeven td {background-color: #CCC}.failedodd td,.attn {background-color: #F33}.failedeven td,.stripe .attn {background-color: #D00}.stacktrace {white-space:pre;font-family:monospace}.totop {font-size:85%;text-align:center;border-bottom:2px solid #000}</style></head><body><table><tr><th>Test</th><th># Passed</th><th># Skipped</th><th># Failed</th><th>Time (ms)</th><th>Included Groups</th><th>Excluded Groups</th></tr><tr><th colspan="7">Command line suite</th></tr><tr><td><a href="#t0">Command line test</a></td><td class="num">23</td><td class="num">0</td><td class="num">0</td><td class="num">7,306</td><td></td><td></td></tr></table><table><thead><tr><th>Class</th><th>Method</th><th>Start</th><th>Time (ms)</th></tr></thead><tbody><tr><th colspan="4">Command line suite</th></tr></tbody><tbody id="t0"><tr><th colspan="4">Command line test &#8212; passed</th></tr><tr class="passedeven"><td rowspan="2">com.triage.learning.tests.TestVariableOverriding</td><td><a href="#m0">testNoOverride</a></td><td rowspan="1">1411852862094</td><td rowspan="1">6</td></tr><tr class="passedeven"><td><a href="#m1">testOverride</a></td><td rowspan="1">1411852862108</td><td rowspan="1">20</td></tr><tr class="passedodd"><td rowspan="2">com.triage.sqlgoat.tests.NormalExecutionTest</td><td><a href="#m2">testBasicBad</a></td><td rowspan="1">1411852855831</td><td rowspan="1">45</td></tr><tr class="passedodd"><td><a href="#m3">testSetup</a></td><td rowspan="1">1411852855939</td><td rowspan="1">0</td></tr><tr class="passedeven"><td rowspan="5">com.triage.sqlgoat.tests.SimpleSqlInjectionTest</td><td><a href="#m4">testBadDynamicSql</a></td><td rowspan="1">1411852856013</td><td rowspan="1">782</td></tr><tr class="passedeven"><td><a href="#m5">testBadPreparedStatements</a></td><td rowspan="1">1411852857153</td><td rowspan="1">315</td></tr><tr class="passedeven"><td><a href="#m6">testNormalDynamicSqlInvalid</a></td><td rowspan="1">1411852857674</td><td rowspan="1">440</td></tr><tr class="passedeven"><td><a href="#m7">testNormalDynamicSqlValid</a></td><td rowspan="1">1411852858277</td><td rowspan="1">296</td></tr><tr class="passedeven"><td><a href="#m8">testNormalPreparedStatements</a></td><td rowspan="1">1411852858730</td><td rowspan="1">233</td></tr><tr class="passedodd"><td rowspan="4">com.triage.sqlgoat.tests.TestBasicSelectors</td><td><a href="#m9">testBasicDynamicWithInjection</a></td><td rowspan="1">1411852859116</td><td rowspan="1">2</td></tr><tr class="passedodd"><td><a href="#m10">testBasicDynamicWithOutInjection</a></td><td rowspan="1">1411852859213</td><td rowspan="1">1</td></tr><tr class="passedodd"><td><a href="#m11">testBasicPreparedWithInjection</a></td><td rowspan="1">1411852859306</td><td rowspan="1">11</td></tr><tr class="passedodd"><td><a href="#m12">testBasicPreparedWithOutInjection</a></td><td rowspan="1">1411852859433</td><td rowspan="1">1</td></tr><tr class="passedeven"><td rowspan="4">com.triage.sqlgoat.tests.TestBytemanScaffold</td><td><a href="#m13">testBytemanRuleFromFile</a></td><td rowspan="1">1411852859435</td><td rowspan="1">80</td></tr><tr class="passedeven"><td><a href="#m14">testBytemanRuleFromFileWithHelper</a></td><td rowspan="1">1411852859529</td><td rowspan="1">76</td></tr><tr class="passedeven"><td><a href="#m15">testInlineBytemanRule</a></td><td rowspan="1">1411852859611</td><td rowspan="1">67</td></tr><tr class="passedeven"><td><a href="#m16">testNoMods</a></td><td rowspan="1">1411852859693</td><td rowspan="1">11</td></tr><tr class="passedodd"><td rowspan="3">com.triage.sqlgoat.tests.TestCleaningStrategies</td><td><a href="#m17">testHtmlXssClean</a></td><td rowspan="1">1411852859705</td><td rowspan="1">554</td></tr><tr class="passedodd"><td><a href="#m18">testJsonBadClean</a></td><td rowspan="1">1411852860260</td><td rowspan="1">12</td></tr><tr class="passedodd"><td><a href="#m19">testJsonClean</a></td><td rowspan="1">1411852860284</td><td rowspan="1">1</td></tr><tr class="passedeven"><td rowspan="3">com.triage.sqlgoat.tests.TestServletXss</td><td><a href="#m20">testBasicInjection</a></td><td rowspan="1">1411852861333</td><td rowspan="1">235</td></tr><tr class="passedeven"><td><a href="#m21">testNoInjection</a></td><td rowspan="1">1411852861648</td><td rowspan="1">3</td></tr><tr class="passedeven"><td><a href="#m22">testXssProtection</a></td><td rowspan="1">1411852861733</td><td rowspan="1">297</td></tr></tbody></table><h2>Command line test</h2><h3 id="m0">com.triage.learning.tests.TestVariableOverriding#testNoOverride</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m1">com.triage.learning.tests.TestVariableOverriding#testOverride</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m2">com.triage.sqlgoat.tests.NormalExecutionTest#testBasicBad</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m3">com.triage.sqlgoat.tests.NormalExecutionTest#testSetup</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m4">com.triage.sqlgoat.tests.SimpleSqlInjectionTest#testBadDynamicSql</h3><table class="result"><tr><th>Expected Exception</th></tr><tr><td><div class="stacktrace">com.triage.rulehelpers.DynamicSqlException: Suspected Dynamic Sql: site=&apos;select * from users where id = 1 OR 3=3&apos;,sql=&apos;Stack trace for thread main
org.hsqldb.jdbc.JDBCConnection.prepareStatement (Unknown Source)
org.apache.commons.dbutils.AbstractQueryRunner.prepareStatement(AbstractQueryRunner.java:154)
org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:345)
org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:307)
com.triage.sqlgoat.database.BasicDynamic.listUsers(BasicDynamic.java:27)
com.triage.sqlgoat.tests.SimpleSqlInjectionTest.listUsersForParameters(SimpleSqlInjectionTest.java:40)
com.triage.sqlgoat.tests.SimpleSqlInjectionTest.testBadDynamicSql(SimpleSqlInjectionTest.java:52)
org.jboss.byteman.contrib.bmunit.BMNGAbstractRunner.run(BMNGAbstractRunner.java:56)
&apos;
	at com.triage.injection.SqlTracker.checkSql(SqlTracker.java:55)
	at com.triage.rulehelpers.TraceMatchingHelper.testSql(TraceMatchingHelper.java:28)
	at org.jboss.byteman.rule.expression.MethodExpression.interpret(MethodExpression.java:342)
	at org.jboss.byteman.rule.Action.interpret(Action.java:144)
	at com.triage.rulehelpers.TraceMatchingHelper_HelperAdapter_Interpreted_1.fire(injectionDetector.btm)
	at com.triage.rulehelpers.TraceMatchingHelper_HelperAdapter_Interpreted_1.execute0(injectionDetector.btm)
	at com.triage.rulehelpers.TraceMatchingHelper_HelperAdapter_Interpreted_1.execute(injectionDetector.btm)
	at org.jboss.byteman.rule.Rule.execute(Rule.java:684)
	at org.jboss.byteman.rule.Rule.execute(Rule.java:653)
	at org.hsqldb.jdbc.JDBCConnection.prepareStatement(Unknown Source)
	at org.apache.commons.dbutils.AbstractQueryRunner.prepareStatement(AbstractQueryRunner.java:154)
	at org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:345)
	at org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:307)
	at com.triage.sqlgoat.database.BasicDynamic.listUsers(BasicDynamic.java:27)
	at com.triage.sqlgoat.tests.SimpleSqlInjectionTest.listUsersForParameters(SimpleSqlInjectionTest.java:40)
	at com.triage.sqlgoat.tests.SimpleSqlInjectionTest.testBadDynamicSql(SimpleSqlInjectionTest.java:52)
	at org.jboss.byteman.contrib.bmunit.BMNGAbstractRunner.run(BMNGAbstractRunner.java:56)
... Removed 76 stack frames</div></td></tr></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m5">com.triage.sqlgoat.tests.SimpleSqlInjectionTest#testBadPreparedStatements</h3><table class="result"><tr><th>Expected Exception</th></tr><tr><td><div class="stacktrace">java.lang.RuntimeException: java.sql.SQLException: data exception: invalid character value for cast Query: select * from users where id = ? Parameters: [1 OR 3=3]
	at com.triage.sqlgoat.database.BasicPrepared.listUsers(BasicPrepared.java:26)
	at com.triage.sqlgoat.tests.SimpleSqlInjectionTest.listUsersForParameters(SimpleSqlInjectionTest.java:40)
	at com.triage.sqlgoat.tests.SimpleSqlInjectionTest.testBadPreparedStatements(SimpleSqlInjectionTest.java:81)
	at org.jboss.byteman.contrib.bmunit.BMNGAbstractRunner.run(BMNGAbstractRunner.java:56)
Caused by: java.sql.SQLException: data exception: invalid character value for cast Query: select * from users where id = ? Parameters: [1 OR 3=3]
	at org.apache.commons.dbutils.AbstractQueryRunner.rethrow(AbstractQueryRunner.java:392)
	at org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:351)
	at org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:247)
	at com.triage.sqlgoat.database.BasicPrepared.listUsers(BasicPrepared.java:24)
	... 39 more
... Removed 36 stack frames</div></td></tr></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m6">com.triage.sqlgoat.tests.SimpleSqlInjectionTest#testNormalDynamicSqlInvalid</h3><table class="result"><tr><th>Expected Exception</th></tr><tr><td><div class="stacktrace">com.triage.rulehelpers.ProbableSqlInjectionException: Suspected Dynamic Sql: site=&apos;select * from users where id = 1 OR 3=3&apos;,sql=&apos;Stack trace for thread main
org.hsqldb.jdbc.JDBCConnection.prepareStatement (Unknown Source)
org.apache.commons.dbutils.AbstractQueryRunner.prepareStatement(AbstractQueryRunner.java:154)
org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:345)
org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:307)
com.triage.sqlgoat.database.BasicDynamic.listUsers(BasicDynamic.java:27)
com.triage.sqlgoat.tests.SimpleSqlInjectionTest.listUsersForParameters(SimpleSqlInjectionTest.java:40)
com.triage.sqlgoat.tests.SimpleSqlInjectionTest.testNormalDynamicSqlInvalid(SimpleSqlInjectionTest.java:67)
org.jboss.byteman.contrib.bmunit.BMNGAbstractRunner.run(BMNGAbstractRunner.java:56)
&apos;
	at com.triage.injection.SqlTracker.checkSql(SqlTracker.java:51)
	at com.triage.rulehelpers.TraceMatchingHelper.testSql(TraceMatchingHelper.java:28)
	at org.jboss.byteman.rule.expression.MethodExpression.interpret(MethodExpression.java:342)
	at org.jboss.byteman.rule.Action.interpret(Action.java:144)
	at com.triage.rulehelpers.TraceMatchingHelper_HelperAdapter_Interpreted_3.fire(injectionDetector.btm)
	at com.triage.rulehelpers.TraceMatchingHelper_HelperAdapter_Interpreted_3.execute0(injectionDetector.btm)
	at com.triage.rulehelpers.TraceMatchingHelper_HelperAdapter_Interpreted_3.execute(injectionDetector.btm)
	at org.jboss.byteman.rule.Rule.execute(Rule.java:684)
	at org.jboss.byteman.rule.Rule.execute(Rule.java:653)
	at org.hsqldb.jdbc.JDBCConnection.prepareStatement(Unknown Source)
	at org.apache.commons.dbutils.AbstractQueryRunner.prepareStatement(AbstractQueryRunner.java:154)
	at org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:345)
	at org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:307)
	at com.triage.sqlgoat.database.BasicDynamic.listUsers(BasicDynamic.java:27)
	at com.triage.sqlgoat.tests.SimpleSqlInjectionTest.listUsersForParameters(SimpleSqlInjectionTest.java:40)
	at com.triage.sqlgoat.tests.SimpleSqlInjectionTest.testNormalDynamicSqlInvalid(SimpleSqlInjectionTest.java:67)
	at org.jboss.byteman.contrib.bmunit.BMNGAbstractRunner.run(BMNGAbstractRunner.java:56)
... Removed 76 stack frames</div></td></tr></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m7">com.triage.sqlgoat.tests.SimpleSqlInjectionTest#testNormalDynamicSqlValid</h3><table class="result"><tr><th>Expected Exception</th></tr><tr><td><div class="stacktrace">com.triage.rulehelpers.DynamicSqlException: Suspected Dynamic Sql: site=&apos;select * from users where id = 3&apos;,sql=&apos;Stack trace for thread main
org.hsqldb.jdbc.JDBCConnection.prepareStatement (Unknown Source)
org.apache.commons.dbutils.AbstractQueryRunner.prepareStatement(AbstractQueryRunner.java:154)
org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:345)
org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:307)
com.triage.sqlgoat.database.BasicDynamic.listUsers(BasicDynamic.java:27)
com.triage.sqlgoat.tests.SimpleSqlInjectionTest.listUsersForParameters(SimpleSqlInjectionTest.java:40)
com.triage.sqlgoat.tests.SimpleSqlInjectionTest.testNormalDynamicSqlValid(SimpleSqlInjectionTest.java:60)
org.jboss.byteman.contrib.bmunit.BMNGAbstractRunner.run(BMNGAbstractRunner.java:56)
&apos;
	at com.triage.injection.SqlTracker.checkSql(SqlTracker.java:55)
	at com.triage.rulehelpers.TraceMatchingHelper.testSql(TraceMatchingHelper.java:28)
	at org.jboss.byteman.rule.expression.MethodExpression.interpret(MethodExpression.java:342)
	at org.jboss.byteman.rule.Action.interpret(Action.java:144)
	at com.triage.rulehelpers.TraceMatchingHelper_HelperAdapter_Interpreted_4.fire(injectionDetector.btm)
	at com.triage.rulehelpers.TraceMatchingHelper_HelperAdapter_Interpreted_4.execute0(injectionDetector.btm)
	at com.triage.rulehelpers.TraceMatchingHelper_HelperAdapter_Interpreted_4.execute(injectionDetector.btm)
	at org.jboss.byteman.rule.Rule.execute(Rule.java:684)
	at org.jboss.byteman.rule.Rule.execute(Rule.java:653)
	at org.hsqldb.jdbc.JDBCConnection.prepareStatement(Unknown Source)
	at org.apache.commons.dbutils.AbstractQueryRunner.prepareStatement(AbstractQueryRunner.java:154)
	at org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:345)
	at org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:307)
	at com.triage.sqlgoat.database.BasicDynamic.listUsers(BasicDynamic.java:27)
	at com.triage.sqlgoat.tests.SimpleSqlInjectionTest.listUsersForParameters(SimpleSqlInjectionTest.java:40)
	at com.triage.sqlgoat.tests.SimpleSqlInjectionTest.testNormalDynamicSqlValid(SimpleSqlInjectionTest.java:60)
	at org.jboss.byteman.contrib.bmunit.BMNGAbstractRunner.run(BMNGAbstractRunner.java:56)
... Removed 76 stack frames</div></td></tr></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m8">com.triage.sqlgoat.tests.SimpleSqlInjectionTest#testNormalPreparedStatements</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m9">com.triage.sqlgoat.tests.TestBasicSelectors#testBasicDynamicWithInjection</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m10">com.triage.sqlgoat.tests.TestBasicSelectors#testBasicDynamicWithOutInjection</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m11">com.triage.sqlgoat.tests.TestBasicSelectors#testBasicPreparedWithInjection</h3><table class="result"><tr><th>Expected Exception</th></tr><tr><td><div class="stacktrace">java.lang.RuntimeException: java.sql.SQLException: data exception: invalid character value for cast Query: select * from users where id = ? Parameters: [1 OR 3=3]
	at com.triage.sqlgoat.database.BasicPrepared.listUsers(BasicPrepared.java:26)
	at com.triage.sqlgoat.tests.TestBasicSelectors.verifyUserCount(TestBasicSelectors.java:28)
	at com.triage.sqlgoat.tests.TestBasicSelectors.testBasicPreparedWithInjection(TestBasicSelectors.java:40)
	at org.jboss.byteman.contrib.bmunit.BMNGAbstractRunner.run(BMNGAbstractRunner.java:56)
Caused by: java.sql.SQLException: data exception: invalid character value for cast Query: select * from users where id = ? Parameters: [1 OR 3=3]
	at org.apache.commons.dbutils.AbstractQueryRunner.rethrow(AbstractQueryRunner.java:392)
	at org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:351)
	at org.apache.commons.dbutils.QueryRunner.query(QueryRunner.java:247)
	at com.triage.sqlgoat.database.BasicPrepared.listUsers(BasicPrepared.java:24)
	... 39 more
... Removed 36 stack frames</div></td></tr></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m12">com.triage.sqlgoat.tests.TestBasicSelectors#testBasicPreparedWithOutInjection</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m13">com.triage.sqlgoat.tests.TestBytemanScaffold#testBytemanRuleFromFile</h3><table class="result"><tr><th>Expected Exception</th></tr><tr><td><div class="stacktrace">java.lang.RuntimeException: worked
	at org.jboss.byteman.rule.expression.ThrowExpression.interpret(ThrowExpression.java:231)
	at org.jboss.byteman.rule.Action.interpret(Action.java:144)
	at org.jboss.byteman.rule.helper.InterpretedHelper.fire(InterpretedHelper.java:169)
	at org.jboss.byteman.rule.helper.InterpretedHelper.execute0(InterpretedHelper.java:137)
	at org.jboss.byteman.rule.helper.InterpretedHelper.execute(InterpretedHelper.java:100)
	at org.jboss.byteman.rule.Rule.execute(Rule.java:684)
	at org.jboss.byteman.rule.Rule.execute(Rule.java:653)
	at java.util.TimeZone.getDisplayName(TimeZone.java)
	at com.triage.sqlgoat.tests.TestBytemanScaffold.testBytemanRuleFromFile(TestBytemanScaffold.java:41)
	at org.jboss.byteman.contrib.bmunit.BMNGAbstractRunner.run(BMNGAbstractRunner.java:56)
... Removed 40 stack frames</div></td></tr></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m14">com.triage.sqlgoat.tests.TestBytemanScaffold#testBytemanRuleFromFileWithHelper</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m15">com.triage.sqlgoat.tests.TestBytemanScaffold#testInlineBytemanRule</h3><table class="result"><tr><th>Expected Exception</th></tr><tr><td><div class="stacktrace">java.lang.RuntimeException: ha ha
	at org.jboss.byteman.rule.expression.ThrowExpression.interpret(ThrowExpression.java:231)
	at org.jboss.byteman.rule.Action.interpret(Action.java:144)
	at org.jboss.byteman.rule.helper.InterpretedHelper.fire(InterpretedHelper.java:169)
	at org.jboss.byteman.rule.helper.InterpretedHelper.execute0(InterpretedHelper.java:137)
	at org.jboss.byteman.rule.helper.InterpretedHelper.execute(InterpretedHelper.java:100)
	at org.jboss.byteman.rule.Rule.execute(Rule.java:684)
	at org.jboss.byteman.rule.Rule.execute(Rule.java:653)
	at java.util.TimeZone.getDisplayName(TimeZone.java)
	at com.triage.sqlgoat.tests.TestBytemanScaffold.testInlineBytemanRule(TestBytemanScaffold.java:35)
	at org.jboss.byteman.contrib.bmunit.BMNGAbstractRunner.run(BMNGAbstractRunner.java:56)
... Removed 40 stack frames</div></td></tr></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m16">com.triage.sqlgoat.tests.TestBytemanScaffold#testNoMods</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m17">com.triage.sqlgoat.tests.TestCleaningStrategies#testHtmlXssClean</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m18">com.triage.sqlgoat.tests.TestCleaningStrategies#testJsonBadClean</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m19">com.triage.sqlgoat.tests.TestCleaningStrategies#testJsonClean</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m20">com.triage.sqlgoat.tests.TestServletXss#testBasicInjection</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m21">com.triage.sqlgoat.tests.TestServletXss#testNoInjection</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p><h3 id="m22">com.triage.sqlgoat.tests.TestServletXss#testXssProtection</h3><table class="result"></table><p class="totop"><a href="#summary">back to summary</a></p></body></html>